{"version":3,"sources":["legacy\\jsx\\core\\view\\admin\\AdminPanelSubscriptionsDetails.jsx"],"names":["Numeral","require","React","Link","Toastr","FinancialStore","SubscriptionStatus","UserSession","LoadingGauge","Messages","module","exports","createClass","contextTypes","router","PropTypes","object","getInitialState","loading","componentDidMount","me","on","subscription","setState","state","invoices","loadSubscription","props","params","id","componentWillReceiveProps","newProps","componentWillUnmount","off","dispatch","action","ACTION_RETRIEVE_SUBSCRIPTION_DETAIL","data","loadInvoices","ACTION_RETRIEVE_SUBSCRIPTION_INVOICES","renderInvoices","length","get","map","invoice","index","console","log","Id","Plan","Name","CreationDate","Day","Month","Year","Status","Description","Amount","format","render","sub","Customer","Fullname","Code","Hour","Minute","NextInvoiceDate"],"mappings":"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","file":"AdminPanelSubscriptionsDetails.jsx","sourceRoot":"C:/Projetos/Nova pasta/ilevus/Ilevus/Views","sourcesContent":["\r\nvar Numeral = require(\"numeral\");\r\nvar React = require(\"react\");\r\nvar Link = require(\"react-router\").Link;\r\nvar Toastr = require(\"toastr\");\r\n\r\nvar FinancialStore = require(\"ilevus/jsx/core/store/Financial.jsx\");\r\nvar SubscriptionStatus = require(\"ilevus/jsx/core/store/moip/SubscriptionStatus.json\");\r\nvar UserSession = require(\"ilevus/jsx/core/store/UserSession.jsx\");\r\n\r\nvar LoadingGauge = require(\"ilevus/jsx/core/widget/LoadingGauge.jsx\");\r\n\r\nvar Messages = require(\"ilevus/jsx/core/util/Messages.jsx\");\r\n\r\nmodule.exports = React.createClass({\r\n    contextTypes: {\r\n        router: React.PropTypes.object\r\n    },\r\n    getInitialState() {\r\n        return {\r\n            loading: true\r\n        };\r\n    },\r\n    componentDidMount() {\r\n        var me = this;\r\n        FinancialStore.on(\"retrieve-subscription-detail\", (subscription) => {\r\n            me.setState({\r\n                loading: !this.state.invoices,\r\n                subscription: subscription,\r\n            });\r\n        }, me);\r\n        FinancialStore.on(\"retrieve-subscription-invoices\", (invoices) => {\r\n            me.setState({\r\n                loading: !this.state.subscription,\r\n                invoices: invoices,\r\n            });\r\n        }, me);\r\n\r\n        this.loadSubscription(this.props.params.id);\r\n    },\r\n    componentWillReceiveProps(newProps) {\r\n        if (this.props.params.id != newProps.params.id) {\r\n            this.loadSubscription(newProps.params.id);\r\n        }\r\n    },\r\n    componentWillUnmount() {\r\n        FinancialStore.off(null, null, this);\r\n    },\r\n\r\n    loadSubscription(id) {\r\n        FinancialStore.dispatch({\r\n            action: FinancialStore.ACTION_RETRIEVE_SUBSCRIPTION_DETAIL,\r\n            data: id,\r\n        });\r\n        this.loadInvoices(id);\r\n    },\r\n    loadInvoices(id) {\r\n        FinancialStore.dispatch({\r\n            action: FinancialStore.ACTION_RETRIEVE_SUBSCRIPTION_INVOICES,\r\n            data: id,\r\n        });\r\n    },\r\n\r\n    renderInvoices(invoices) {\r\n        if (!invoices || invoices.length <= 0) {\r\n            return <i>{Messages.get(\"TextNoCreditCardYet\")}</i>;\r\n        }\r\n        return (<table className=\"ilv-table\">\r\n            <thead>\r\n                <tr>\r\n                    <th>{Messages.get(\"LabelCode\")}</th>\r\n                    <th>{Messages.get(\"LabelPlan\")}</th>\r\n                    <th>{Messages.get(\"LabelCreatedAt\")}</th>\r\n                    <th>{Messages.get(\"LabelStatus\")}</th>\r\n                    <th>{Messages.get(\"LabelTotal\")}</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                {invoices.map((invoice, index) => {\r\n                    console.log(invoice);\r\n                    return (<tr key={\"invoice-\" + index}>\r\n                        <td><Link to={\"/admin/subscriptions/invoice/\" + invoice.Id}>\r\n                            {invoice.Id}\r\n                        </Link></td>\r\n                        <td>\r\n                            {invoice.Plan.Name}\r\n                        </td>\r\n                        <td>\r\n                            {invoice.CreationDate.Day}/{invoice.CreationDate.Month}/{invoice.CreationDate.Year}\r\n                        </td>\r\n                        <td>\r\n                            {invoice.Status.Description}\r\n                        </td>\r\n                        <td>\r\n                            R${Numeral(invoice.Amount / 100).format(\"0,0.00\")}\r\n                        </td>\r\n                    </tr>);\r\n                })}\r\n            </tbody>\r\n        </table>);\r\n    },\r\n\r\n    render() {\r\n        if (this.state.loading) {\r\n            return <LoadingGauge />;\r\n        }\r\n        var sub = this.state.subscription;\r\n        return (<div>\r\n            <h2>{Messages.get(\"LabelSubscriptionDetail\")}</h2>\r\n            <div className=\"ilv-card\">\r\n                <div className=\"ilv-card-header\">\r\n                    <h4>\r\n                        {sub.Customer.Fullname}\r\n                    </h4>\r\n                </div>\r\n                <div className=\"ilv-card-body\">\r\n                    <div className=\"row mb-2\">\r\n                        <div className=\"col col-md-6\">\r\n                            <div className=\"ilv-small\">{Messages.get(\"LabelCode\")}</div>\r\n                            <b>{sub.Code}</b>\r\n                        </div>\r\n                        <div className=\"col col-md-6\">\r\n                            <div className=\"ilv-small\">{Messages.get(\"LabelCreatedAt\")}</div>\r\n                            <b>{sub.CreationDate.Day}/{sub.CreationDate.Month}/{sub.CreationDate.Year}\r\n                                &nbsp;{Messages.get(\"LabelAt\")} {sub.CreationDate.Hour}:{sub.CreationDate.Minute}\r\n                            </b>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"row mb-2\">\r\n                        <div className=\"col col-md-6\">\r\n                            <div className=\"ilv-small\">{Messages.get(\"LabelStatus\")}</div>\r\n                            <b>{SubscriptionStatus[sub.Status]}</b>\r\n                        </div>\r\n                        <div className=\"col col-md-6\">\r\n                            <div className=\"ilv-small\">{Messages.get(\"LabelNextInvoiceDate\")}</div>\r\n                            <b>{sub.NextInvoiceDate.Day}/{sub.NextInvoiceDate.Month}/{sub.NextInvoiceDate.Year}</b>\r\n                        </div>\r\n                    </div>\r\n\r\n                     <hr className=\"mb-4\" />\r\n                    <div className=\"mb-4\"><strong>{Messages.get(\"LabelInvoices\")}</strong></div>\r\n\r\n                    {this.renderInvoices(this.state.invoices)}\r\n\r\n                </div>\r\n            </div>\r\n        </div>);\r\n    }\r\n});\r\n"]}