{"version":3,"sources":["legacy\\jsx\\core\\view\\notifications\\NotificationsTimeline.jsx"],"names":["S","require","React","Link","Toastr","NotificationStore","UserSession","LoadingGauge","Messages","module","exports","createClass","contextTypes","router","PropTypes","object","getInitialState","loading","notifications","filtro","opcaoFiltro","naoLidas","componentDidMount","me","on","data","setTimeout","setState","allNot","qtdeNotifications","user","get","dispatch","action","ACTION_USER_NOTIFICATIONS","Id","e","console","log","marcarLido","element","id","preventDefault","ACTION_READ_NOTIFICATION","deleteNotification","ACTION_DELETE_NOTIFICATION","alterarFiltroExibicao","event","target","value","showAllNotifications","state","qtde","i","length","Status","itensFiltrados","retorno","filter","componentWillUnmount","off","renderNotification","items","map","contact","idx","dest","Subject","DateNotification","bind","render","cursor"],"mappings":"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","file":"NotificationsTimeline.jsx","sourceRoot":"C:/Projetos/Nova pasta/ilevus/Ilevus/Views","sourcesContent":["var S = require(\"string\");\r\n\r\nvar React = require(\"react\");\r\nvar Link = require(\"react-router\").Link;\r\nvar Toastr = require(\"toastr\");\r\n\r\nvar NotificationStore = require(\"ilevus/jsx/core/store/notifications/Notification.jsx\");\r\n\r\nvar UserSession = require(\"ilevus/jsx/core/store/UserSession.jsx\");\r\nvar LoadingGauge = require(\"ilevus/jsx/core/widget/LoadingGauge.jsx\");\r\nvar Messages = require(\"ilevus/jsx/core/util/Messages.jsx\");\r\n\r\nmodule.exports = React.createClass({\r\n    contextTypes: {\r\n        router: React.PropTypes.object\r\n    },\r\n    getInitialState() {\r\n        return {\r\n            loading: true,\r\n            notifications: [],\r\n            filtro: false,\r\n            opcaoFiltro: \"0\",\r\n            naoLidas: 0\r\n        };\r\n    },\r\n    componentDidMount() {\r\n        \r\n        try{\r\n            var me = this;\r\n            NotificationStore.on(\"notificationsuser\", (data) => {\r\n                setTimeout(() => {\r\n                    //if (!this.state.notifications || data.length != this.state.notifications.length) {\r\n                        me.setState({\r\n                            notifications: data,\r\n                            allNot: data,                            \r\n                            loading: false\r\n                        });\r\n                        this.qtdeNotifications();\r\n\r\n                        //for (var i = 0; i <= 2; i++) {\r\n                        //    this.state.notifications.push(this.state.allNot[i]);\r\n                        //}\r\n                    //}\r\n                }, 10);\r\n                           \r\n            }, me);\r\n\r\n            var user = UserSession.get(\"user\");\r\n\r\n            NotificationStore.dispatch({\r\n                action: NotificationStore.ACTION_USER_NOTIFICATIONS,\r\n                data: {Id: user.Id}\r\n            });        \r\n        } catch (e) {\r\n            console.log(e)\r\n        }\r\n    },\r\n    marcarLido(element, id) {\r\n        id.preventDefault();        \r\n        NotificationStore.dispatch({\r\n            action: NotificationStore.ACTION_READ_NOTIFICATION,\r\n            data: element\r\n        });\r\n    },\r\n    deleteNotification(element, id) {\r\n        id.preventDefault();        \r\n        NotificationStore.dispatch({\r\n            action: NotificationStore.ACTION_DELETE_NOTIFICATION,\r\n            data: element\r\n        });\r\n    },\r\n    alterarFiltroExibicao(event) {\r\n        var user = UserSession.get(\"user\");\r\n        this.setState({\r\n            filtro: event.target.value == \"0\" ? false : true,\r\n            opcaoFiltro: event.target.value\r\n        });\r\n        NotificationStore.dispatch({\r\n            action: NotificationStore.ACTION_USER_NOTIFICATIONS,\r\n            data: { Id: user.Id }\r\n        });\r\n    },\r\n    showAllNotifications() {\r\n        this.state.notifications = this.state.allNot;\r\n    },\r\n    qtdeNotifications() {\r\n        var qtde = 0;\r\n        for (var i = 0; i < this.state.notifications.length; i++) {\r\n            if (!this.state.notifications[0].Status)\r\n                qtde++;\r\n        }\r\n\r\n        this.setState({\r\n            naoLidas: qtde\r\n        });\r\n    },\r\n    itensFiltrados() {\r\n        if (!this.state.filtro)\r\n            return this.state.notifications;\r\n\r\n        var retorno = this.state.notifications.filter(function (value) {\r\n            return value.Status == true;\r\n        });\r\n\r\n        return retorno;\r\n    },\r\n    componentWillUnmount() {\r\n        NotificationStore.off(null, null, this);\r\n    },\r\n\r\n    renderNotification() {\r\n        var items;\r\n        if (!this.state.notifications || this.state.notifications.length == 0) {\r\n            return <div className=\"ilv-notification ilv-notification-unread\">nenhuma notificação</div>\r\n        }\r\n\r\n        items = this.state.notifications.map((contact, idx) => {\r\n            var dest = contact.Id;\r\n            if (this.state.filtro && contact.Status) {\r\n                return <div></div>\r\n            }\r\n\r\n            return <div className={\"ilv-notification \" + (!contact.Status ? 'ilv-notification-unread' : '')}>\r\n                            <Link to={\"/notifications/timeline_detalhe/\" + dest} key={\"item-\" + idx}>\r\n                               <div className=\"ilv-media ilv-media-middle\">\r\n                                   <div className=\"ilv-media-body\">\r\n                                       <p className=\"mb-0\">{contact.Subject}</p>\r\n                                       <small className=\"text-muted\">{contact.DateNotification}</small>\r\n                                   </div>\r\n                                   <div className=\"ilv-media-right\">\r\n                                       <div className=\"dropdown\">\r\n                                           <button className=\"ilv-btn ilv-btn-clean\" data-toggle=\"dropdown\">\r\n                                               <i className=\"ilv-btn-icon material-icons md-24\">&#xE5D3;</i>\r\n                                           </button>\r\n                                           <ul className=\"dropdown-menu dropdown-menu-right\">\r\n                                               <a href=\"\" onClick={this.marcarLido.bind(this, dest)} className=\"dropdown-item\">{Messages.get(\"MarkAsRead\")}</a>\r\n                                               <a href=\"\" onClick={this.deleteNotification.bind(this, dest)} className=\"dropdown-item\">{Messages.get(\"DeleteNotification\")}</a>\r\n                                           </ul>\r\n                                       </div>\r\n                                   </div>\r\n                               </div>\r\n                            </Link>\r\n                           </div>\r\n        })\r\n        return <div>{items}</div>\r\n    },\r\n    \r\n    render() {\r\n        \r\n        return (\r\n            <div>\r\n                <div className=\"ilv-media ilv-media-middle mb-4\">\r\n                    <div className=\"ilv-media-body\">\r\n                        <h4>{Messages.get(\"YourNotifications\")} ({this.state.naoLidas})</h4>\r\n                    </div>\r\n                    <div className=\"ilv-media-right\">\r\n                        <select className=\"ilv-form-control\" value={this.state.opcaoFiltro} onChange={this.alterarFiltroExibicao}>\r\n                            <option value=\"0\">{Messages.get(\"AllNotifications\")}</option>\r\n                            <option value=\"1\">{Messages.get(\"UnreadNotifications\")}</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n                \r\n                <div className=\"ilv-notification-list\">\r\n                   {this.renderNotification()}\r\n                    <div className=\"text-center py-3\">\r\n                        <a style={{cursor: \"pointer\"}} onClick={this.showAllNotifications}>{Messages.get(\"LoadMoreNotifications\")}</a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n});\r\n"]}