{"version":3,"sources":["legacy\\jsx\\core\\widget\\coaching\\SessionTimer.jsx"],"names":["_","require","moment","numeral","React","CoachingStore","Messages","Modal","module","exports","createClass","propTypes","process","PropTypes","object","isRequired","session","isCoach","bool","getDefaultProps","componentDidMount","updateDurationCounter","componentWillReceiveProps","sessionDuration","newSession","event","preventDefault","dispatch","action","ACTION_NEW_SESSION","data","props","Id","startSession","ACTION_START_SESSION","finishSession","me","confirm","get","ACTION_FINISH_SESSION","hide","el","refs","Status","duration","diff","Started","add","hours","minutes","seconds","innerHTML","format","isMounted","delay","render","latestFinished","Sessions","length","currentDuration","Finished","currentDurationString"],"mappings":";;AACA,IAAIA,IAAIC,QAAQ,YAAR,CAAR;AACA,IAAIC,SAASD,QAAQ,QAAR,CAAb;AACA,IAAIE,UAAUF,QAAQ,SAAR,CAAd;AACA,IAAIG,QAAQH,QAAQ,OAAR,CAAZ;;AAEA,IAAII,gBAAgBJ,QAAQ,oCAAR,CAApB;;AAEA,IAAIK,WAAWL,QAAQ,mCAAR,CAAf;AACA,IAAIM,QAAQN,QAAQ,kCAAR,CAAZ;;AAEAO,OAAOC,OAAP,GAAiBL,MAAMM,WAAN,CAAkB;AAAA;;AAC/BC,eAAW;AACPC,iBAASR,MAAMS,SAAN,CAAgBC,MAAhB,CAAuBC,UADzB;AAEPC,iBAASZ,MAAMS,SAAN,CAAgBC,MAAhB,CAAuBC,UAFzB;AAGPE,iBAASb,MAAMS,SAAN,CAAgBK,IAAhB,CAAqBH;AAHvB,KADoB;AAM/BI,mBAN+B,6BAMb;AACd,eAAO;AACHP,qBAAS;AADN,SAAP;AAGH,KAV8B;AAY/BQ,qBAZ+B,+BAYX;AAChB,aAAKC,qBAAL;AACH,KAd8B;AAe/BC,6BAf+B,uCAeH;AACxB,aAAKC,eAAL,GAAuB,IAAvB;AACH,KAjB8B;AAmB/BC,cAnB+B,sBAmBpBC,KAnBoB,EAmBb;AACdA,iBAASA,MAAMC,cAAN,EAAT;AACArB,sBAAcsB,QAAd,CAAuB;AACnBC,oBAAQvB,cAAcwB,kBADH;AAEnBC,kBAAM,KAAKC,KAAL,CAAWnB,OAAX,CAAmBoB;AAFN,SAAvB;AAIH,KAzB8B;AA0B/BC,gBA1B+B,wBA0BlBR,KA1BkB,EA0BX;AAChBA,iBAASA,MAAMC,cAAN,EAAT;AACArB,sBAAcsB,QAAd,CAAuB;AACnBC,oBAAQvB,cAAc6B,oBADH;AAEnBJ,kBAAM,KAAKC,KAAL,CAAWnB,OAAX,CAAmBoB;AAFN,SAAvB;AAIH,KAhC8B;AAiC/BG,iBAjC+B,yBAiCjBV,KAjCiB,EAiCV;AAAA;;AACjBA,iBAASA,MAAMC,cAAN,EAAT;AACA,YAAIU,KAAK,IAAT;AACA7B,cAAM8B,OAAN,CAAc/B,SAASgC,GAAT,CAAa,gBAAb,CAAd,EAA8ChC,SAASgC,GAAT,CAAa,+BAAb,CAA9C,EAA6F,YAAM;AAC/FjC,0BAAcsB,QAAd,CAAuB;AACnBC,wBAAQvB,cAAckC,qBADH;AAEnBT,sBAAMM,GAAGL,KAAH,CAASnB,OAAT,CAAiBoB;AAFJ,aAAvB;AAIA,kBAAKT,eAAL,GAAuB,IAAvB;AACAhB,kBAAMiC,IAAN;AACH,SAPD;AAQH,KA5C8B;AA8C/BnB,yBA9C+B,mCA8CP;AACpB,YAAIoB,KAAK,KAAKC,IAAL,CAAU,kBAAV,CAAT;AAAA,YACI1B,UAAU,KAAKe,KAAL,CAAWf,OADzB;AAEA,YAAIA,QAAQ2B,MAAR,IAAkB,CAAlB,IAAuBF,EAA3B,EAA+B;AAC3B,gBAAI,CAAC,KAAKlB,eAAV,EAA2B;AACvB,qBAAKA,eAAL,GAAuBrB,OAAO0C,QAAP,CAAgB1C,SAAS2C,IAAT,CAAc3C,OAAOc,QAAQ8B,OAAf,CAAd,EAAuC,SAAvC,CAAhB,EAAmE,SAAnE,CAAvB;AACH,aAFD,MAEO;AACH,qBAAKvB,eAAL,CAAqBwB,GAArB,CAAyB,CAAzB,EAA4B,SAA5B;AACH;AACD,gBAAIC,QAAQ7C,QAAQ,KAAKoB,eAAL,CAAqByB,KAArB,EAAR,CAAZ;AAAA,gBACIC,UAAU9C,QAAQ,KAAKoB,eAAL,CAAqB0B,OAArB,EAAR,CADd;AAAA,gBAEIC,UAAU/C,QAAQ,KAAKoB,eAAL,CAAqB2B,OAArB,EAAR,CAFd;AAGAT,eAAGU,SAAH,GAAeH,MAAMI,MAAN,CAAa,IAAb,IAAqB,GAArB,GAA2BH,QAAQG,MAAR,CAAe,IAAf,CAA3B,GAAkD,GAAlD,GAAwDF,QAAQE,MAAR,CAAe,IAAf,CAAvE;AACH;AACD,YAAI,KAAKC,SAAL,EAAJ,EACIrD,EAAEsD,KAAF,CAAQ,KAAKjC,qBAAb,EAAoC,IAApC;AACP,KA9D8B;AAiE/BkC,UAjE+B,oBAiEtB;AACL,YAAIC,iBAAiB,KAAKzB,KAAL,CAAWnB,OAAX,CAAmB6C,QAAnB,CAA4B,KAAK1B,KAAL,CAAWnB,OAAX,CAAmB6C,QAAnB,CAA4BC,MAA5B,GAAqC,CAAjE,EAAoEf,MAApE,IAA8E,EAAnG;AAAA,YACIgB,kBAAkB,KAAK5B,KAAL,CAAWf,OAAX,CAAmB2B,MAAnB,IAA6B,EAA7B,GAAkCzC,OAAO0C,QAAP,CAAgB1C,OAAO,KAAK6B,KAAL,CAAWf,OAAX,CAAmB4C,QAA1B,EAAoCf,IAApC,CAAyC3C,OAAO,KAAK6B,KAAL,CAAWf,OAAX,CAAmB8B,OAA1B,CAAzC,EAA6E,SAA7E,CAAhB,EAAyG,SAAzG,CAAlC,GAAwJ,IAD9K;AAAA,YAEIe,wBAAwBF,kBACpBxD,QAAQwD,gBAAgBX,KAAhB,EAAR,EAAiCI,MAAjC,CAAwC,IAAxC,IAAgD,GAAhD,GACAjD,QAAQwD,gBAAgBV,OAAhB,EAAR,EAAmCG,MAAnC,CAA0C,IAA1C,CADA,GACkD,GADlD,GAEAjD,QAAQwD,gBAAgBT,OAAhB,EAAR,EAAmCE,MAAnC,CAA0C,IAA1C,CAHoB,GAIpB,IANR;AAQA,eAAQ;AAAA;AAAA,cAAK,WAAU,eAAf;AACH,iBAAKrB,KAAL,CAAWf,OAAX,CAAmB2B,MAAnB,IAA6B,CAA7B,GAAiC;AAAA;AAAA,kBAAK,WAAU,6BAAf;AAC9B;AAAA;AAAA;AAAIrC,6BAASgC,GAAT,CAAa,iBAAb;AAAJ,iBAD8B;AAE7B,qBAAKP,KAAL,CAAWd,OAAX,GAAqB;AAAA;AAAA,sBAAQ,WAAU,uDAAlB,EAA0E,SAAS,KAAKgB,YAAxF;AAAuG3B,6BAASgC,GAAT,CAAa,mBAAb;AAAvG,iBAArB,GAA0K;AAF7I,aAAjC,GAGS,KAAKP,KAAL,CAAWf,OAAX,CAAmB2B,MAAnB,GAA4B,EAA5B,GAAiC;AAAA;AAAA,kBAAK,WAAU,6BAAf;AACvC;AAAA;AAAA;AAAQrC,6BAASgC,GAAT,CAAa,sBAAb,CAAR;AAAA;AAAA,iBADuC;AAEvC,4CAAI,WAAU,MAAd,EAAqB,KAAI,kBAAzB,GAFuC;AAGtC,qBAAKP,KAAL,CAAWd,OAAX,GAAqB;AAAA;AAAA,sBAAQ,WAAU,sDAAlB,EAAyE,SAAS,KAAKkB,aAAvF;AAAwG7B,6BAASgC,GAAT,CAAa,iBAAb;AAAxG,iBAArB,GAAyK;AAHnI,aAAjC,GAIH;AAAA;AAAA,kBAAK,WAAU,6BAAf;AACH;AAAA;AAAA;AAAQhC,6BAASgC,GAAT,CAAa,sBAAb,CAAR;AAAA;AAAA,iBADG;AAEH;AAAA;AAAA,sBAAI,WAAU,MAAd;AACKuB;AADL,iBAFG;AAKH;AAAA;AAAA;AAAIvD,6BAASgC,GAAT,CAAa,eAAb;AAAJ;AALG,aARH;AAeHkB,8BAAkB,KAAKzB,KAAL,CAAWd,OAA7B,GAAuC;AAAA;AAAA,kBAAK,WAAU,gBAAf;AACpC;AAAA;AAAA,sBAAQ,WAAU,+CAAlB,EAAkE,SAAS,KAAKO,UAAhF;AAA8FlB,6BAASgC,GAAT,CAAa,iBAAb;AAA9F;AADoC,aAAvC,GAEQ;AAjBL,SAAR;AAmBH;AA7F8B,CAAlB,CAAjB","file":"SessionTimer.jsx","sourceRoot":"C:/Projetos/Nova pasta/ilevus/Ilevus/Views","sourcesContent":["\r\nvar _ = require(\"underscore\");\r\nvar moment = require(\"moment\");\r\nvar numeral = require(\"numeral\");\r\nvar React = require('react');\r\n\r\nvar CoachingStore = require(\"ilevus/jsx/core/store/Coaching.jsx\");\r\n\r\nvar Messages = require(\"ilevus/jsx/core/util/Messages.jsx\");\r\nvar Modal = require(\"ilevus/jsx/core/widget/Modal.jsx\");\r\n\r\nmodule.exports = React.createClass({\r\n    propTypes: {\r\n        process: React.PropTypes.object.isRequired,\r\n        session: React.PropTypes.object.isRequired,\r\n        isCoach: React.PropTypes.bool.isRequired,\r\n    },\r\n    getDefaultProps() {\r\n        return {\r\n            process: null\r\n        };\r\n    },\r\n\r\n    componentDidMount() {\r\n        this.updateDurationCounter();\r\n    },\r\n    componentWillReceiveProps() {\r\n        this.sessionDuration = null;\r\n    },\r\n\r\n    newSession(event) {\r\n        event && event.preventDefault();\r\n        CoachingStore.dispatch({\r\n            action: CoachingStore.ACTION_NEW_SESSION,\r\n            data: this.props.process.Id\r\n        });\r\n    },\r\n    startSession(event) {\r\n        event && event.preventDefault();\r\n        CoachingStore.dispatch({\r\n            action: CoachingStore.ACTION_START_SESSION,\r\n            data: this.props.process.Id\r\n        });\r\n    },\r\n    finishSession(event) {\r\n        event && event.preventDefault();\r\n        var me = this;\r\n        Modal.confirm(Messages.get(\"TextAreYouSure\"), Messages.get(\"TextSessionFinishConfirmation\"), () => {\r\n            CoachingStore.dispatch({\r\n                action: CoachingStore.ACTION_FINISH_SESSION,\r\n                data: me.props.process.Id\r\n            });\r\n            this.sessionDuration = null;\r\n            Modal.hide();\r\n        });\r\n    },\r\n\r\n    updateDurationCounter() {\r\n        var el = this.refs[\"duration-counter\"],\r\n            session = this.props.session;\r\n        if (session.Status == 5 && el) {\r\n            if (!this.sessionDuration) {\r\n                this.sessionDuration = moment.duration(moment().diff(moment(session.Started), \"seconds\"), \"seconds\");\r\n            } else {\r\n                this.sessionDuration.add(1, \"seconds\");\r\n            }\r\n            var hours = numeral(this.sessionDuration.hours()),\r\n                minutes = numeral(this.sessionDuration.minutes()),\r\n                seconds = numeral(this.sessionDuration.seconds());\r\n            el.innerHTML = hours.format(\"00\") + \":\" + minutes.format(\"00\") + \":\" + seconds.format(\"00\");\r\n        }\r\n        if (this.isMounted())\r\n            _.delay(this.updateDurationCounter, 1000);\r\n    },\r\n\r\n\r\n    render() {\r\n        var latestFinished = this.props.process.Sessions[this.props.process.Sessions.length - 1].Status >= 10,\r\n            currentDuration = this.props.session.Status >= 10 ? moment.duration(moment(this.props.session.Finished).diff(moment(this.props.session.Started), \"seconds\"), \"seconds\") : null,\r\n            currentDurationString = currentDuration ? (\r\n                numeral(currentDuration.hours()).format(\"00\") + \":\" +\r\n                numeral(currentDuration.minutes()).format(\"00\") + \":\" +\r\n                numeral(currentDuration.seconds()).format(\"00\")\r\n            ) : null\r\n        ;\r\n        return (<div className=\"ilv-card mb-5\">\r\n            {this.props.session.Status == 0 ? <div className=\"ilv-card-header text-center\">\r\n                <i>{Messages.get(\"LabelNotStarted\")}</i>\r\n                {this.props.isCoach ? <button className=\"ilv-btn ilv-btn-lg ilv-btn-block ilv-btn-success mt-2\" onClick={this.startSession}>{Messages.get(\"LabelStartSession\")}</button> : \"\"}\r\n            </div> : (this.props.session.Status < 10 ? <div className=\"ilv-card-header text-center\">\r\n                <small>{Messages.get(\"LabelSessionDuration\")}:</small>\r\n                <h1 className=\"mb-3\" ref=\"duration-counter\"></h1>\r\n                {this.props.isCoach ? <button className=\"ilv-btn ilv-btn-lg ilv-btn-block ilv-btn-destructive\" onClick={this.finishSession }>{Messages.get(\"LabelEndSession\")}</button> : \"\"}\r\n            </div>:<div className=\"ilv-card-header text-center\">\r\n                <small>{Messages.get(\"LabelSessionDuration\")}:</small>\r\n                <h1 className=\"mb-3\">\r\n                    {currentDurationString}\r\n                </h1>\r\n                <i>{Messages.get(\"LabelFinished\")}</i>\r\n            </div>)}\r\n            {latestFinished && this.props.isCoach ? <div className=\"ilv-card-block\">\r\n                <button className=\"ilv-btn ilv-btn-lg ilv-btn-block ilv-btn-link\" onClick={this.newSession }>{Messages.get(\"LabelNewSession\")}</button>\r\n            </div> : \"\"}\r\n        </div>);\r\n    }\r\n});\r\n"]}